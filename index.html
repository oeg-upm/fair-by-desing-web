<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Inicio – FAIRbyDesign</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/app.css" rel="stylesheet">
</head>
<body>
  <div class="page">

    <!-- HEADER -->
    <div class="header-wrap">
      <header class="shadow-sm">
        <div class="container-fluid g-0 p-0">
          <div class="row g-0 align-items-stretch w-100">

            <!-- Bloque izquierdo -->
            <button
              type="button"
              id="brandMenuToggle"
              class="col-auto d-flex align-items-center justify-content-center brand-block header-height border-0 text-decoration-none"
              aria-label="Abrir menú FAIRbyDesign">
              <i class="bi bi-list me-2"></i>
              <span class="fw-bold text-dark">FAIRbyDesign</span>
            </button>

            <!-- Barra azul con navbar -->
            <div class="col bg-nav">
              <nav class="navbar navbar-expand-sm header-height px-3 bg-nav">
                <button class="navbar-toggler ms-auto" type="button" data-bs-toggle="collapse"
                        data-bs-target="#topNav" aria-controls="topNav" aria-expanded="false"
                        aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="topNav">
                  <ul class="navbar-nav ms-auto gap-sm-4">
                    <li class="nav-item"><a class="nav-link" target="_top" href="/index.html">XXXXX</a></li>
                    <li class="nav-item"><a class="nav-link" target="_top" href="/principles.html">XXXXXXX</a></li>
                    <li class="nav-item"><a class="nav-link" target="_top" href="/why.html">XXXX</a></li>
                  </ul>
                </div>
              </nav>
            </div>

          </div>
        </div>
      </header>
    </div>

    <!-- Map -->
    <div class="page-content mb-0">
      <main class="container py-2 pb-0">  
        <p class="text-center fw-bold mb-3">
          Click on the ontology development phases or activities to get actionable steps to accomplish them
        </p>
        <div class="position-relative" style="max-width:1140px; margin:auto;">
          
          

          <img src="assets/FiguraLOT.svg" class="img-fluid d-block " alt="Mapa FAIRbyDesign" onload="sendHeight()">
          <a class="hotspot" data-page="partials/conceptualization.html" href="javascript:void(0);" onclick="loadContent('partials/conceptualization.html')" style="left:14.74%; top:20.06%; width:10.53%; height:17.96%;"></a>
          <a class="hotspot" data-page="partials/encoding.html" href="javascript:void(0);" onclick="loadContent('partials/encoding.html')" data-key="encoding" style="left:29.65%; top:20.06%; width:10.53%; height:17.96%;"></a>
          <a class="hotspot" data-page="partials/evaluation.html" href="javascript:void(0);" onclick="loadContent('partials/evaluation.html')" style="left:44.85%; top:20.06%; width:10.53%; height:17.96%;"></a>
          <a class="hotspot" data-page="partials/documentation.html" href="javascript:void(0);" onclick="loadContent('partials/documentation.html')" style="left:59.7%; top:20.06%; width:10.53%; height:17.96%;"></a>
          <a class="hotspot" data-page="partials/requirements.html" href="javascript:void(0);" onclick="loadContent('partials/requirements.html')" style="left:0.09%; top:20.21%; width:10.53%; height:17.96%;"></a>
          <a class="hotspot" data-page="partials/publication.html" href="javascript:void(0);" onclick="loadContent('partials/publication.html')" style="left:74.3%; top:20.06%; width:10.53%; height:17.96%;"></a>
          <a class="hotspot" data-page="partials/maintenance.html" href="javascript:void(0);" onclick="loadContent('partials/maintenance.html')" style="left:89.48%; top:20.21%; width:10.51%; height:17.96%;"></a>
          <a class="hotspot" data-page="partials/reuse.html" href="javascript:void(0);" onclick="loadContent('partials/reuse.html')" style="left:23.5%; top:79.4%; width:10.53%; height:17.96%;"></a>

          <button id="prevBtn" class="nav-arrow nav-arrow--left" onclick="navigate(-1)" aria-label="Anterior" style="display:none;">
            <i class="bi bi-chevron-left"></i>
          </button>
          <button id="nextBtn" class="nav-arrow nav-arrow--right" onclick="navigate(1)" aria-label="Siguiente">
            <i class="bi bi-chevron-right"></i>
          </button>

        </div>
      </main>

      <script>

      function sendHeight() {
        const h = Math.max(
          document.body.scrollHeight, document.documentElement.scrollHeight,
          document.body.offsetHeight,  document.documentElement.offsetHeight
        );
        parent.postMessage({ type: 'MAP_HEIGHT', height: h }, '*');
      }

      function enableHoverHighlight(){
        document.querySelectorAll('.hotspot').forEach(el => {
          el.addEventListener('mouseenter', () => {
            el.classList.add('hotspot--active');
            requestAnimationFrame(sendHeight);
          });
          el.addEventListener('mouseleave', () => {
            el.classList.remove('hotspot--active');
            requestAnimationFrame(sendHeight);
          });
        });
      }
      enableHoverHighlight();

      function highlightActive() {
        const key = (new URLSearchParams(location.search).get('active') || '').toLowerCase();
        if (!key) return;
        const el = document.querySelector('.hotspot[data-key="' + key + '"]');
        if (el) placePinOn(el);        // <-- sin crear ningún .pin nuevo
      }

      // Inicializa
      window.addEventListener('DOMContentLoaded', () => {
        highlightActive();
        enableHotspotPin();
        sendHeight();
      });
      window.addEventListener('resize', sendHeight);

      if('ResizeObserver' in window){
        new ResizeObserver(sendHeight).observe(document.body);
      }

      function placePinOn(el) {
        // Quitar chincheta de cualquier hotspot anterior
        document.querySelectorAll('.hotspot--current')
          .forEach(hs => hs.classList.remove('hotspot--current'));

        // Poner chincheta en el hotspot actual
        if (el) {
          el.classList.add('hotspot--current');
        }
      }

      function enableHotspotPin() {
        document.querySelectorAll('.hotspot').forEach(el => {
          el.addEventListener('click', () => {
            placePinOn(el);
            requestAnimationFrame(sendHeight);
          });
        });
      }

      </script>
    </div>

    <div class="page-content" id="contentContainer">
      
    </div>

    <!-- FOOTER (siempre abajo) -->
    <div class="footer-wrap">
      <style>
        :root{ --footer-bg:#f8fafc; --footer-border:#e5e7eb; --link:#4965ab; }
        footer{ background:var(--footer-bg); border-top:1px solid var(--footer-border); }
        .footer-content{ padding:18px 12px; color:#46505a; font-size:.95rem; }
        a{ color:var(--link); text-decoration:none; font-weight:600; }
        a:hover{ text-decoration:underline; }
      </style>
      <footer>
        <div class="container footer-content d-flex flex-column flex-sm-row align-items-center justify-content-between gap-2">
          <div>© <span id="y"></span> FAIRbyDesign · All rights reserved</div>
          <div class="d-flex gap-3">
            <a href="/principles.html">Principles</a>
            <a href="/why.html">Why?</a>
            <a href="/index.html">Top</a>
          </div>
        </div>
      </footer>
    </div>

  </div>

  <!-- Menú lateral superpuesto -->
<div id="brandMenuBackdrop" class="brand-menu-backdrop" style="display:none;"></div>

<nav id="brandSideMenu" class="brand-side-menu" aria-hidden="true">
  <div class="brand-side-menu__inner">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h2 class="h5 mb-0">FAIRbyDesign</h2>
      <button type="button" class="btn-close" id="brandMenuClose" aria-label="Cerrar"></button>
    </div>

    <div class="d-grid gap-2">
      <button type="button" class="btn btn-pill text-start" onclick="loadContent('partials/principal.html')">
        Top / Overview
      </button>
      <button type="button" class="btn btn-pill text-start" onclick="loadContent('partials/requirements.html')">
        Requirements
      </button>
      <button type="button" class="btn btn-pill text-start" onclick="loadContent('partials/conceptualization.html')">
        Conceptualization
      </button>
      <button type="button" class="btn btn-pill text-start" onclick="loadContent('partials/encoding.html')">
        Encoding
      </button>
      <button type="button" class="btn btn-pill text-start" onclick="loadContent('partials/evaluation.html')">
        Evaluation
      </button>
      <!-- Añade aquí los botones que quieras -->
    </div>
  </div>
</nav>

<script>

  let currentPageIndex = -1; // Índice actual de la página

      // Lista de las páginas HTML del mapa
      const pages = [
        'partials/requirements.html',
        'partials/conceptualization.html',
        'partials/reuse.html',
        'partials/encoding.html',
        'partials/evaluation.html',
        'partials/documentation.html',
        'partials/publication.html',
        'partials/maintenance.html'
      ];

  function updateNavButtons(){
    if (currentPageIndex === -1 || currentPageIndex === 0) {
        prevBtn.style.display = "none";     // ocultar
    } else {
        prevBtn.style.display = "block";    // mostrar
    }

    // NEXT BUTTON
    if (currentPageIndex === pages.length - 1) {
        nextBtn.style.display = "none";     // ocultar
    } else {
        nextBtn.style.display = "block";    // mostrar
    }
  }

  function loadContent(contentFile) {

    const idx = pages.indexOf(contentFile);
    if (idx !== -1) {
      currentPageIndex = idx;
      updateNavButtons();
    }

    updateHotspotPinFor(contentFile);

    const container = document.getElementById('contentContainer');
    container.innerHTML = '';

    fetch(contentFile)
      .then(response => response.text())
      .then(html => {
        container.innerHTML = html;

        if (container.querySelector('.pillbar')) {
        initializeButtonEvents();
      }

      // Solo encoding tiene drag & drop
      if (contentFile === 'partials/encoding.html') {
        if (typeof initializeDragAndDrop === 'function') {
          initializeDragAndDrop();
        }
        if (typeof initializeMetadataForm === 'function') {
          initializeMetadataForm();
        }
        checkVersionSchema(null)
      }
      })
    .catch(error => console.error('Error al cargar el contenido:', error));
  }

  function navigate(direction) {
    currentPageIndex += direction; // Cambiar el índice
    if (currentPageIndex < 0) {
      currentPageIndex = 0; // No permitir que sea menor a 0
    }
    if (currentPageIndex >= pages.length) {
      currentPageIndex = pages.length - 1; // No permitir que sea mayor al número de páginas
    }

    // Cargar la página correspondiente
    loadContent(pages[currentPageIndex]);
  }

  function updateHotspotPinFor(contentFile) {
  const el = document.querySelector('.hotspot[data-page="' + contentFile + '"]');
  if (!el) return; // si no hay hotspot asociado, no tocamos la chincheta

  if (typeof placePinOn === 'function') {
    placePinOn(el);
  }
}


  // Función para inicializar los botones después de cargar el HTML
  function initializeButtonEvents() {
    const pills = document.querySelectorAll('.pillbar .btn-pill'); // Los botones
    const blocks = document.querySelectorAll('.fair-content .block'); // Los bloques de contenido

    function update() {
      const active = new Set(
        Array.from(pills)
          .filter(b => b.classList.contains('active')) // Solo los botones con la clase 'active'
          .map(b => b.dataset.key) // Obtener las claves del dataset de los botones
      );
      blocks.forEach(b => {
        if (active.has(b.dataset.key)) {
          b.classList.add('show'); // Mostrar el bloque
        } else {
          b.classList.remove('show'); // Ocultar el bloque
        }
      });
    }

    pills.forEach(btn => {
      btn.addEventListener('click', () => {
        btn.classList.toggle('active');

        if (!btn.classList.contains('active')) {
            btn.classList.add('toggled'); // Añadir el estilo de tachado
        } else {
            btn.classList.remove('toggled'); // Quitar el tachado
        }

        update(); // Actualizar los bloques que se muestran
      });
    });

    // Estado inicial (si quieres alguno marcado por defecto, actívalo aquí)
    pills[0].classList.add('active');
    update(); // Llamar a update para mostrar el contenido correspondiente al primer botón
  }

  // Llamar a la función para cargar el contenido principal cuando la página se carga por primera vez
  window.onload = function() {
    loadContent('partials/principal.html'); // Aquí especificas el archivo principal
  }

  

  document.addEventListener('DOMContentLoaded', () => {
  const toggleBtn  = document.getElementById('brandMenuToggle');
  const sideMenu   = document.getElementById('brandSideMenu');
  const backdrop   = document.getElementById('brandMenuBackdrop');
  const closeBtn   = document.getElementById('brandMenuClose');

  if (!toggleBtn || !sideMenu || !backdrop) return;

  function openMenu(){
    sideMenu.classList.add('brand-side-menu--open');
    backdrop.style.display = 'block';
    sideMenu.setAttribute('aria-hidden', 'false');
  }

  function closeMenu(){
    sideMenu.classList.remove('brand-side-menu--open');
    backdrop.style.display = 'none';
    sideMenu.setAttribute('aria-hidden', 'true');
  }

  toggleBtn.addEventListener('click', openMenu);
  closeBtn?.addEventListener('click', closeMenu);
  backdrop.addEventListener('click', closeMenu);

  // Cerrar con ESC
  document.addEventListener('keydown', (ev) => {
    if (ev.key === 'Escape') closeMenu();
  });
});


</script>
<script src="scripts/scriptsEncoding.js"></script>
<script src="scripts/scriptsFoops.js"></script>
  <div class="floating-shortcuts">
    <button type="button" class="btn btn-pill floating-btn" id="btnToTop" aria-label="Ir arriba">
      Top
    </button>
    <button type="button" class="btn btn-pill floating-btn" id="btnToWhy" aria-label="Ir a Why">
      Why?
    </button>
    <button type="button" class="btn btn-pill floating-btn" id="btnToPrinciples" aria-label="Ir a Principles">
      Principles
    </button>
  </div>
</body>
</html>
